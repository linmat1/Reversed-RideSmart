{"ast":null,"code":"var _jsxFileName = \"/Users/linmat/Documents/GitHub/Reversed-RideSmart/frontend/src/BookingStatusPanel.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\nimport './BookingStatusPanel.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_BASE = process.env.REACT_APP_API_URL || 'http://localhost:5001';\nfunction formatStatus(status) {\n  if (!status) return 'idle';\n  return String(status);\n}\nfunction BookingStatusPanel() {\n  _s();\n  const [snapshot, setSnapshot] = useState(null);\n  const [connected, setConnected] = useState(false);\n  const [collapsed, setCollapsed] = useState(() => {\n    try {\n      return localStorage.getItem('bookingStatusCollapsed') === 'true';\n    } catch {\n      return false;\n    }\n  });\n  const [error, setError] = useState(null);\n  const [cancellingRideIds, setCancellingRideIds] = useState(() => new Set());\n  const pollingRef = useRef(null);\n  const eventSourceRef = useRef(null);\n  const users = useMemo(() => (snapshot === null || snapshot === void 0 ? void 0 : snapshot.users) || [], [snapshot]);\n  const fetchSnapshot = async () => {\n    try {\n      const res = await fetch(`${API_BASE}/api/status`);\n      if (!res.ok) throw new Error(`HTTP ${res.status}`);\n      const data = await res.json();\n      setSnapshot(data);\n      setError(null);\n    } catch (e) {\n      setError((e === null || e === void 0 ? void 0 : e.message) || 'failed to load status');\n    }\n  };\n  const startPolling = () => {\n    if (pollingRef.current) return;\n    pollingRef.current = setInterval(() => {\n      fetchSnapshot();\n    }, 3000);\n  };\n  const stopPolling = () => {\n    if (pollingRef.current) {\n      clearInterval(pollingRef.current);\n      pollingRef.current = null;\n    }\n  };\n  useEffect(() => {\n    // Always fetch an initial snapshot.\n    fetchSnapshot();\n\n    // Prefer SSE for real-time sync across all clients.\n    try {\n      const es = new EventSource(`${API_BASE}/api/status/stream`);\n      eventSourceRef.current = es;\n      es.onopen = () => {\n        setConnected(true);\n        setError(null);\n        stopPolling();\n      };\n      es.onmessage = evt => {\n        try {\n          const payload = JSON.parse(evt.data);\n          if ((payload === null || payload === void 0 ? void 0 : payload.type) === 'snapshot') {\n            setSnapshot(payload.data);\n          }\n        } catch {\n          // ignore parse errors\n        }\n      };\n      es.onerror = () => {\n        setConnected(false);\n        // Fall back to polling. Mobile networks can be flaky; polling keeps UI in sync.\n        startPolling();\n        try {\n          es.close();\n        } catch {\n          // ignore\n        }\n      };\n    } catch (e) {\n      setConnected(false);\n      startPolling();\n    }\n    return () => {\n      stopPolling();\n      if (eventSourceRef.current) {\n        try {\n          eventSourceRef.current.close();\n        } catch {\n          // ignore\n        }\n        eventSourceRef.current = null;\n      }\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  useEffect(() => {\n    try {\n      localStorage.setItem('bookingStatusCollapsed', String(collapsed));\n    } catch {\n      // ignore\n    }\n  }, [collapsed]);\n  const cancelRide = async (userKey, rideId) => {\n    setCancellingRideIds(prev => {\n      const next = new Set(prev);\n      next.add(rideId);\n      return next;\n    });\n    try {\n      const res = await fetch(`${API_BASE}/api/lyft/cancel-booking`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          user_id: userKey,\n          ride_id: rideId\n        })\n      });\n      const data = await res.json().catch(() => ({}));\n      if (!res.ok || !data.success) {\n        throw new Error((data === null || data === void 0 ? void 0 : data.message) || `cancel failed (HTTP ${res.status})`);\n      }\n      // Snapshot should update via SSE/polling; also do a quick refresh.\n      fetchSnapshot();\n    } catch (e) {\n      setError((e === null || e === void 0 ? void 0 : e.message) || 'cancel failed');\n    } finally {\n      setCancellingRideIds(prev => {\n        const next = new Set(prev);\n        next.delete(rideId);\n        return next;\n      });\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"booking-status-panel\",\n    \"aria-label\": \"Booking status panel\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"booking-status-header\",\n      onClick: () => setCollapsed(c => !c),\n      role: \"button\",\n      tabIndex: 0,\n      onKeyDown: e => {\n        if (e.key === 'Enter' || e.key === ' ') setCollapsed(c => !c);\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"booking-status-title\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"Bookings\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"booking-status-conn\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: `booking-dot ${connected ? 'connected' : ''}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 13\n          }, this), connected ? 'live' : 'polling']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"booking-status-actions\",\n        onClick: e => e.stopPropagation(),\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"booking-status-btn\",\n          onClick: fetchSnapshot,\n          type: \"button\",\n          children: \"Refresh\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"booking-status-btn\",\n          onClick: () => setCollapsed(c => !c),\n          type: \"button\",\n          children: collapsed ? 'Open' : 'Hide'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 7\n    }, this), !collapsed && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"booking-status-body\",\n      children: [error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"booking-empty\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Error:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 15\n        }, this), \" \", error]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 13\n      }, this), users.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"booking-empty\",\n        children: \"No users loaded (check backend `.env` user variables).\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 13\n      }, this), users.map(u => {\n        const rides = u.active_rides || [];\n        const status = formatStatus(u.status);\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"booking-user\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"booking-user-top\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"booking-user-name\",\n              children: u.user_name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 196,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"booking-user-status\",\n              children: status\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 197,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 17\n          }, this), u.message ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"booking-user-message\",\n            children: u.message\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 30\n          }, this) : null, rides.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"booking-empty\",\n            children: [u.user_name, \": none in progress\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 19\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"booking-rides\",\n            children: rides.map(r => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"booking-ride\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"booking-ride-left\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"booking-ride-type\",\n                  children: [r.ride_type || 'Ride', \" booked\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 208,\n                  columnNumber: 27\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"booking-ride-id\",\n                  children: [\"id: \", r.ride_id]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 211,\n                  columnNumber: 27\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 207,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"booking-cancel-btn\",\n                type: \"button\",\n                onClick: () => cancelRide(u.user_key, r.ride_id),\n                disabled: cancellingRideIds.has(r.ride_id),\n                children: cancellingRideIds.has(r.ride_id) ? 'Cancelling…' : 'Cancel'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 213,\n                columnNumber: 25\n              }, this)]\n            }, `${u.user_key}-${r.ride_id}`, true, {\n              fileName: _jsxFileName,\n              lineNumber: 206,\n              columnNumber: 23\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 19\n          }, this)]\n        }, u.user_key, true, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 15\n        }, this);\n      })]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 149,\n    columnNumber: 5\n  }, this);\n}\n_s(BookingStatusPanel, \"a+iRozXyWW8PZLHrN9rKY/rsiN0=\");\n_c = BookingStatusPanel;\nexport default BookingStatusPanel;\nvar _c;\n$RefreshReg$(_c, \"BookingStatusPanel\");","map":{"version":3,"names":["React","useEffect","useMemo","useRef","useState","jsxDEV","_jsxDEV","API_BASE","process","env","REACT_APP_API_URL","formatStatus","status","String","BookingStatusPanel","_s","snapshot","setSnapshot","connected","setConnected","collapsed","setCollapsed","localStorage","getItem","error","setError","cancellingRideIds","setCancellingRideIds","Set","pollingRef","eventSourceRef","users","fetchSnapshot","res","fetch","ok","Error","data","json","e","message","startPolling","current","setInterval","stopPolling","clearInterval","es","EventSource","onopen","onmessage","evt","payload","JSON","parse","type","onerror","close","setItem","cancelRide","userKey","rideId","prev","next","add","method","headers","body","stringify","user_id","ride_id","catch","success","delete","className","children","onClick","c","role","tabIndex","onKeyDown","key","fileName","_jsxFileName","lineNumber","columnNumber","stopPropagation","length","map","u","rides","active_rides","user_name","r","ride_type","user_key","disabled","has","_c","$RefreshReg$"],"sources":["/Users/linmat/Documents/GitHub/Reversed-RideSmart/frontend/src/BookingStatusPanel.js"],"sourcesContent":["import React, { useEffect, useMemo, useRef, useState } from 'react';\nimport './BookingStatusPanel.css';\n\nconst API_BASE = process.env.REACT_APP_API_URL || 'http://localhost:5001';\n\nfunction formatStatus(status) {\n  if (!status) return 'idle';\n  return String(status);\n}\n\nfunction BookingStatusPanel() {\n  const [snapshot, setSnapshot] = useState(null);\n  const [connected, setConnected] = useState(false);\n  const [collapsed, setCollapsed] = useState(() => {\n    try {\n      return localStorage.getItem('bookingStatusCollapsed') === 'true';\n    } catch {\n      return false;\n    }\n  });\n  const [error, setError] = useState(null);\n  const [cancellingRideIds, setCancellingRideIds] = useState(() => new Set());\n\n  const pollingRef = useRef(null);\n  const eventSourceRef = useRef(null);\n\n  const users = useMemo(() => snapshot?.users || [], [snapshot]);\n\n  const fetchSnapshot = async () => {\n    try {\n      const res = await fetch(`${API_BASE}/api/status`);\n      if (!res.ok) throw new Error(`HTTP ${res.status}`);\n      const data = await res.json();\n      setSnapshot(data);\n      setError(null);\n    } catch (e) {\n      setError(e?.message || 'failed to load status');\n    }\n  };\n\n  const startPolling = () => {\n    if (pollingRef.current) return;\n    pollingRef.current = setInterval(() => {\n      fetchSnapshot();\n    }, 3000);\n  };\n\n  const stopPolling = () => {\n    if (pollingRef.current) {\n      clearInterval(pollingRef.current);\n      pollingRef.current = null;\n    }\n  };\n\n  useEffect(() => {\n    // Always fetch an initial snapshot.\n    fetchSnapshot();\n\n    // Prefer SSE for real-time sync across all clients.\n    try {\n      const es = new EventSource(`${API_BASE}/api/status/stream`);\n      eventSourceRef.current = es;\n\n      es.onopen = () => {\n        setConnected(true);\n        setError(null);\n        stopPolling();\n      };\n\n      es.onmessage = (evt) => {\n        try {\n          const payload = JSON.parse(evt.data);\n          if (payload?.type === 'snapshot') {\n            setSnapshot(payload.data);\n          }\n        } catch {\n          // ignore parse errors\n        }\n      };\n\n      es.onerror = () => {\n        setConnected(false);\n        // Fall back to polling. Mobile networks can be flaky; polling keeps UI in sync.\n        startPolling();\n        try {\n          es.close();\n        } catch {\n          // ignore\n        }\n      };\n    } catch (e) {\n      setConnected(false);\n      startPolling();\n    }\n\n    return () => {\n      stopPolling();\n      if (eventSourceRef.current) {\n        try {\n          eventSourceRef.current.close();\n        } catch {\n          // ignore\n        }\n        eventSourceRef.current = null;\n      }\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    try {\n      localStorage.setItem('bookingStatusCollapsed', String(collapsed));\n    } catch {\n      // ignore\n    }\n  }, [collapsed]);\n\n  const cancelRide = async (userKey, rideId) => {\n    setCancellingRideIds(prev => {\n      const next = new Set(prev);\n      next.add(rideId);\n      return next;\n    });\n\n    try {\n      const res = await fetch(`${API_BASE}/api/lyft/cancel-booking`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ user_id: userKey, ride_id: rideId })\n      });\n      const data = await res.json().catch(() => ({}));\n      if (!res.ok || !data.success) {\n        throw new Error(data?.message || `cancel failed (HTTP ${res.status})`);\n      }\n      // Snapshot should update via SSE/polling; also do a quick refresh.\n      fetchSnapshot();\n    } catch (e) {\n      setError(e?.message || 'cancel failed');\n    } finally {\n      setCancellingRideIds(prev => {\n        const next = new Set(prev);\n        next.delete(rideId);\n        return next;\n      });\n    }\n  };\n\n  return (\n    <div className=\"booking-status-panel\" aria-label=\"Booking status panel\">\n      <div\n        className=\"booking-status-header\"\n        onClick={() => setCollapsed(c => !c)}\n        role=\"button\"\n        tabIndex={0}\n        onKeyDown={(e) => {\n          if (e.key === 'Enter' || e.key === ' ') setCollapsed(c => !c);\n        }}\n      >\n        <div className=\"booking-status-title\">\n          <span>Bookings</span>\n          <span className=\"booking-status-conn\">\n            <span className={`booking-dot ${connected ? 'connected' : ''}`} />\n            {connected ? 'live' : 'polling'}\n          </span>\n        </div>\n        <div className=\"booking-status-actions\" onClick={(e) => e.stopPropagation()}>\n          <button className=\"booking-status-btn\" onClick={fetchSnapshot} type=\"button\">\n            Refresh\n          </button>\n          <button className=\"booking-status-btn\" onClick={() => setCollapsed(c => !c)} type=\"button\">\n            {collapsed ? 'Open' : 'Hide'}\n          </button>\n        </div>\n      </div>\n\n      {!collapsed && (\n        <div className=\"booking-status-body\">\n          {error && (\n            <div className=\"booking-empty\">\n              <strong>Error:</strong> {error}\n            </div>\n          )}\n\n          {users.length === 0 && (\n            <div className=\"booking-empty\">\n              No users loaded (check backend `.env` user variables).\n            </div>\n          )}\n\n          {users.map((u) => {\n            const rides = u.active_rides || [];\n            const status = formatStatus(u.status);\n            return (\n              <div className=\"booking-user\" key={u.user_key}>\n                <div className=\"booking-user-top\">\n                  <div className=\"booking-user-name\">{u.user_name}</div>\n                  <div className=\"booking-user-status\">{status}</div>\n                </div>\n                {u.message ? <div className=\"booking-user-message\">{u.message}</div> : null}\n\n                {rides.length === 0 ? (\n                  <div className=\"booking-empty\">{u.user_name}: none in progress</div>\n                ) : (\n                  <div className=\"booking-rides\">\n                    {rides.map((r) => (\n                      <div className=\"booking-ride\" key={`${u.user_key}-${r.ride_id}`}>\n                        <div className=\"booking-ride-left\">\n                          <div className=\"booking-ride-type\">\n                            {r.ride_type || 'Ride'} booked\n                          </div>\n                          <div className=\"booking-ride-id\">id: {r.ride_id}</div>\n                        </div>\n                        <button\n                          className=\"booking-cancel-btn\"\n                          type=\"button\"\n                          onClick={() => cancelRide(u.user_key, r.ride_id)}\n                          disabled={cancellingRideIds.has(r.ride_id)}\n                        >\n                          {cancellingRideIds.has(r.ride_id) ? 'Cancelling…' : 'Cancel'}\n                        </button>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            );\n          })}\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default BookingStatusPanel;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}